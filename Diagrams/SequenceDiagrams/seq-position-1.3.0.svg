<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1779px" preserveAspectRatio="none" style="width:1751px;height:1779px;" version="1.1" viewBox="0 0 1751 1779" width="1751px" zoomAndPan="magnify"><defs><filter height="300%" id="fgc395ob0pk1v" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="361" x="696" y="23.5352">1.3.0. Position Handler Consume (single message)</text><rect fill="#FFFFE0" height="1734.1035" style="stroke: #A80036; stroke-width: 1.0;" width="1695" x="29" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="826" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="159" y="182.2188"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="419.5" y="692.832"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="671.5" y="1203.4453"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="1594.8164" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="933.5" y="112.2871"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="1580.8164" style="stroke: #000000; stroke-width: 2.0;" width="1727" x="13" y="119.2871"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="1549.5059" style="stroke: #000000; stroke-width: 2.0;" width="1707" x="23" y="143.5977"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="524.5" x="859" y="227.2188"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="869" y="251.5293"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="347.4609"/><rect fill="#FFFFFF" height="510.6133" style="stroke: none; stroke-width: 1.0;" width="1707" x="23" y="656.5664"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="525.5" x="859" y="737.832"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="505.5" x="869" y="762.1426"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="858.0742"/><rect fill="#FFFFFF" height="525.9238" style="stroke: none; stroke-width: 1.0;" width="1707" x="23" y="1167.1797"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="121.5527" style="stroke: #000000; stroke-width: 2.0;" width="409.5" x="859" y="1248.4453"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="90.2422" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="869" y="1272.7559"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="1383.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="164" x2="164" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="424" x2="424" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="676" x2="676" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="938" x2="938" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1374" x2="1374" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1500" x2="1500" y1="102.2871" y2="1717.1035"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1646" x2="1646" y1="102.2871" y2="1717.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="37" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="33" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="240" x="40" y="87.334">topic-usd-dfsp1-position-prepare</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="37" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="33" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="240" x="40" y="1740.6387">topic-usd-dfsp1-position-prepare</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="309" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="305" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="217" x="312" y="87.334">topic-usd-dfsp2-position-fulfil</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="309" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="305" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="217" x="312" y="1740.6387">topic-usd-dfsp2-position-fulfil</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="558" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="554" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="223" x="561" y="87.334">topic-usd-dfsp1-position-abort</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="558" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="554" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="223" x="561" y="1740.6387">topic-usd-dfsp1-position-abort</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="879" y="99.334">Position Handler</text><ellipse cx="938.5" cy="69.7988" fill="#FEFECE" filter="url(#fgc395ob0pk1v)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="934.5,57.7988,940.5,52.7988,938.5,57.7988,940.5,62.7988,934.5,57.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="879" y="1729.6387">Position Handler</text><ellipse cx="938.5" cy="1748.5918" fill="#FEFECE" filter="url(#fgc395ob0pk1v)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="934.5,1736.5918,940.5,1731.5918,938.5,1736.5918,940.5,1741.5918,934.5,1736.5918" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1326" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1322" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1329" y="87.334">Event-Topic</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1326" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1322" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1329" y="1740.6387">Event-Topic</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1441" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1437" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1444" y="87.334">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1441" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1437" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1444" y="1740.6387">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1577" y="62.7988"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1573" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1580" y="87.334">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1577" y="1716.1035"/><rect fill="#FEFECE" filter="url(#fgc395ob0pk1v)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1573" y="1720.1035"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1580" y="1740.6387">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="159" y="182.2188"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="419.5" y="692.832"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="671.5" y="1203.4453"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="1594.8164" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="933.5" y="112.2871"/><path d="M13,119.2871 L236,119.2871 L236,126.2871 L226,136.2871 L13,136.2871 L13,119.2871 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1580.8164" style="stroke: #000000; stroke-width: 2.0;" width="1727" x="13" y="119.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="28" y="132.8555">Position Handler Consume</text><path d="M23,143.5977 L85,143.5977 L85,150.5977 L75,160.5977 L23,160.5977 L23,143.5977 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1549.5059" style="stroke: #000000; stroke-width: 2.0;" width="1707" x="23" y="143.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="157.166">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="213" x="100" y="156.2324">[Consume Prepare message for Payer]</text><polygon fill="#A80036" points="180,178.2188,170,182.2188,180,186.2188,176,182.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174" x2="932.5" y1="182.2188" y2="182.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="186" y="177.4766">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="199" y="177.4766">Consume Position event message for Payer</text><path d="M859,227.2188 L943,227.2188 L943,234.2188 L933,244.2188 L859,244.2188 L859,227.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="524.5" x="859" y="227.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="874" y="240.7871">break</text><path d="M869,251.5293 L1011,251.5293 L1011,258.5293 L1001,268.5293 L869,268.5293 L869,251.5293 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="869" y="251.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="884" y="265.0977">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="985.5" y1="305.4609" y2="305.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="985.5" x2="985.5" y1="305.4609" y2="318.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="944.5" x2="985.5" y1="318.4609" y2="318.4609"/><polygon fill="#A80036" points="954.5,314.4609,944.5,318.4609,954.5,322.4609,950.5,318.4609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="293.0635">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="398" x="963.5" y="285.4082">Validate event - Rule: type == 'position' &amp;&amp; action == 'prepare'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="963.5" y="300.7188">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1047.5" y="300.7188">2001</text><path d="M869,347.4609 L1084,347.4609 L1084,354.4609 L1074,364.4609 L869,364.4609 L869,347.4609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="347.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="884" y="361.0293">Persist Event Information</text><polygon fill="#A80036" points="1362.5,407.082,1372.5,411.082,1362.5,415.082,1366.5,411.082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1368.5" y1="411.082" y2="411.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="406.3398">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="963.5" y="406.3398">Publish event information</text><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="876" y="419.082"/><polygon fill="#EEEEEE" points="876,419.082,940,419.082,940,426.082,930,436.082,876,436.082,876,419.082" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="433.6504">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1052" y="452.6504">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1210" y="452.6504">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1210" x2="1246" y1="454.6504" y2="454.6504"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1246" y="452.6504">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1056" y="467.9609"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="328" x="876" y="537.0137"/><polygon fill="#EEEEEE" points="876,537.0137,940,537.0137,940,544.0137,930,554.0137,876,554.0137,876,537.0137" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="551.582">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="882" y="570.582">Prepare Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="87" x="1107" y="570.582">1.3.1-prepare</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1107" x2="1194" y1="572.582" y2="572.582"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1194" y="570.582">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="886" y="585.8926"/><polygon fill="#A80036" points="1488,615.2559,1498,619.2559,1488,623.2559,1492,619.2559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1494" y1="619.2559" y2="619.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="614.5137">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="963.5" y="614.5137">Produce message</text><polygon fill="#A80036" points="1634.5,644.5664,1644.5,648.5664,1634.5,652.5664,1638.5,648.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1640.5" y1="648.5664" y2="648.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="643.8242">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="963.5" y="643.8242">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1730" y1="657.5664" y2="657.5664"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="28" y="668.2012">[Consume Fulfil message for Payee]</text><polygon fill="#A80036" points="440.5,688.832,430.5,692.832,440.5,696.832,436.5,692.832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434.5" x2="932.5" y1="692.832" y2="692.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="446.5" y="688.0898">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="459.5" y="688.0898">Consume Position event message for Payee</text><path d="M859,737.832 L943,737.832 L943,744.832 L933,754.832 L859,754.832 L859,737.832 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="525.5" x="859" y="737.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="874" y="751.4004">break</text><path d="M869,762.1426 L1011,762.1426 L1011,769.1426 L1001,779.1426 L869,779.1426 L869,762.1426 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="505.5" x="869" y="762.1426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="884" y="775.7109">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="985.5" y1="816.0742" y2="816.0742"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="985.5" x2="985.5" y1="816.0742" y2="829.0742"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="944.5" x2="985.5" y1="829.0742" y2="829.0742"/><polygon fill="#A80036" points="954.5,825.0742,944.5,829.0742,954.5,833.0742,950.5,829.0742" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="803.6768">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="399" x="963.5" y="796.0215">Validate event - Rule: type == 'position' &amp;&amp; action == 'commit'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="963.5" y="811.332">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1047.5" y="811.332">2001</text><path d="M869,858.0742 L1084,858.0742 L1084,865.0742 L1074,875.0742 L869,875.0742 L869,858.0742 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="858.0742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="884" y="871.6426">Persist Event Information</text><polygon fill="#A80036" points="1362.5,917.6953,1372.5,921.6953,1362.5,925.6953,1366.5,921.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1368.5" y1="921.6953" y2="921.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="916.9531">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="963.5" y="916.9531">Publish event information</text><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="876" y="929.6953"/><polygon fill="#EEEEEE" points="876,929.6953,940,929.6953,940,936.6953,930,946.6953,876,946.6953,876,929.6953" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="944.2637">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1052" y="963.2637">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1210" y="963.2637">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1210" x2="1246" y1="965.2637" y2="965.2637"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1246" y="963.2637">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1056" y="978.5742"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="297" x="876" y="1047.627"/><polygon fill="#EEEEEE" points="876,1047.627,940,1047.627,940,1054.627,930,1064.627,876,1064.627,876,1047.627" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="1062.1953">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="882" y="1081.1953">Fulfil Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="70" x="1093" y="1081.1953">1.3.2-fulfil</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1093" x2="1163" y1="1083.1953" y2="1083.1953"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1163" y="1081.1953">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="886" y="1096.5059"/><polygon fill="#A80036" points="1488,1125.8691,1498,1129.8691,1488,1133.8691,1492,1129.8691" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1494" y1="1129.8691" y2="1129.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="950.5" y="1125.127">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="963.5" y="1125.127">Produce message</text><polygon fill="#A80036" points="1634.5,1155.1797,1644.5,1159.1797,1634.5,1163.1797,1638.5,1159.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1640.5" y1="1159.1797" y2="1159.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="950.5" y="1154.4375">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="972.5" y="1154.4375">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1730" y1="1168.1797" y2="1168.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="28" y="1178.8145">[Consume Abort message]</text><polygon fill="#A80036" points="692.5,1199.4453,682.5,1203.4453,692.5,1207.4453,688.5,1203.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686.5" x2="932.5" y1="1203.4453" y2="1203.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="698.5" y="1198.7031">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="720.5" y="1198.7031">Consume Position event message</text><path d="M859,1248.4453 L943,1248.4453 L943,1255.4453 L933,1265.4453 L859,1265.4453 L859,1248.4453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="121.5527" style="stroke: #000000; stroke-width: 2.0;" width="409.5" x="859" y="1248.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="874" y="1262.0137">break</text><path d="M869,1272.7559 L1011,1272.7559 L1011,1279.7559 L1001,1289.7559 L869,1289.7559 L869,1272.7559 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2422" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="869" y="1272.7559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="884" y="1286.3242">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="985.5" y1="1341.998" y2="1341.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="985.5" x2="985.5" y1="1341.998" y2="1354.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="944.5" x2="985.5" y1="1354.998" y2="1354.998"/><polygon fill="#A80036" points="954.5,1350.998,944.5,1354.998,954.5,1358.998,950.5,1354.998" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="950.5" y="1321.9453">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="972.5" y="1306.6348">Validate event - Rule: type == 'position' &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="972.5" y="1321.9453">action IN ['timeout-reserved', 'reject', 'fail']</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="972.5" y="1337.2559">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1056.5" y="1337.2559">2001</text><path d="M869,1383.998 L1084,1383.998 L1084,1390.998 L1074,1400.998 L869,1400.998 L869,1383.998 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="869" y="1383.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="884" y="1397.5664">Persist Event Information</text><polygon fill="#A80036" points="1362.5,1443.6191,1372.5,1447.6191,1362.5,1451.6191,1366.5,1447.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1368.5" y1="1447.6191" y2="1447.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="950.5" y="1442.877">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="972.5" y="1442.877">Publish event information</text><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="876" y="1455.6191"/><polygon fill="#EEEEEE" points="876,1455.6191,940,1455.6191,940,1462.6191,930,1472.6191,876,1472.6191,876,1455.6191" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="1470.1875">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1052" y="1489.1875">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1210" y="1489.1875">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1210" x2="1246" y1="1491.1875" y2="1491.1875"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1246" y="1489.1875">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1056" y="1504.498"/><rect fill="#FFFFFF" filter="url(#fgc395ob0pk1v)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="303" x="876" y="1573.5508"/><polygon fill="#EEEEEE" points="876,1573.5508,940,1573.5508,940,1580.5508,930,1590.5508,876,1590.5508,876,1573.5508" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="889" y="1588.1191">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="882" y="1607.1191">Abort Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="73" x="1096" y="1607.1191">1.3.3-abort</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1096" x2="1169" y1="1609.1191" y2="1609.1191"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1169" y="1607.1191">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="886" y="1622.4297"/><polygon fill="#A80036" points="1488,1651.793,1498,1655.793,1488,1659.793,1492,1655.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1494" y1="1655.793" y2="1655.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="950.5" y="1651.0508">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="972.5" y="1651.0508">Produce message</text><polygon fill="#A80036" points="1634.5,1681.1035,1644.5,1685.1035,1634.5,1689.1035,1638.5,1685.1035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="943.5" x2="1640.5" y1="1685.1035" y2="1685.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="950.5" y="1680.3613">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="972.5" y="1680.3613">Produce message</text><!--
@startuml
title 1.3.0. Position Handler Consume (single message)

autonumber


collections "topic-usd-dfsp1-position-prepare" as TOPIC_POSITION_PREPARE_DFSP1
collections "topic-usd-dfsp2-position-fulfil" as TOPIC_POSITION_FULFIL_DFSP2
collections "topic-usd-dfsp1-position-abort" as TOPIC_POSITION_ABORT_DFSP1
control "Position Handler" as POS_HANDLER
collections "Transfer-Topic" as TOPIC_TRANSFERS
collections "Event-Topic" as TOPIC_EVENTS
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Central Service" #LightYellow
    participant TOPIC_POSITION_PREPARE_DFSP1
    participant TOPIC_POSITION_FULFIL_DFSP2
    participant TOPIC_POSITION_ABORT_DFSP1
    participant POS_HANDLER
    participant TOPIC_EVENTS
    participant TOPIC_TRANSFERS
    participant TOPIC_NOTIFICATIONS
end box

activate POS_HANDLER
group Position Handler Consume
    alt Consume Prepare message for Payer
        TOPIC_POSITION_PREPARE_DFSP1 <- POS_HANDLER: Consume Position event message for Payer
        activate TOPIC_POSITION_PREPARE_DFSP1
        deactivate TOPIC_POSITION_PREPARE_DFSP1
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'prepare'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Prepare Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg 1.3.1-prepare]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Fulfil message for Payee
        TOPIC_POSITION_FULFIL_DFSP2 <- POS_HANDLER: Consume Position event message for Payee
        activate TOPIC_POSITION_FULFIL_DFSP2
        deactivate TOPIC_POSITION_FULFIL_DFSP2
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'commit'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Fulfil Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg 1.3.2-fulfil]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Abort message
        TOPIC_POSITION_ABORT_DFSP1 <- POS_HANDLER: Consume Position event message
        activate TOPIC_POSITION_ABORT_DFSP1
        deactivate TOPIC_POSITION_ABORT_DFSP1
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' &&\naction IN ['timeout-reserved', 'reject', 'fail']\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Abort Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg 1.3.3-abort]]} \n
        POS_HANDLER -> TOPIC_TRANSFERS: Produce message
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    end

end
deactivate POS_HANDLER
@enduml

PlantUML version 1.2018.05(Sat May 05 23:00:17 EEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>