<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1691px" preserveAspectRatio="none" style="width:1606px;height:1691px;" version="1.1" viewBox="0 0 1606 1691" width="1606px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kxtnecmup16y" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="361" x="623.5" y="23.5352">1.3.0. Position Handler Consume (single message)</text><rect fill="#FFFFE0" height="1646.1719" style="stroke: #A80036; stroke-width: 1.0;" width="1550" x="29" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="753.5" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="159" y="181.9082"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="419.5" y="663.2109"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="671.5" y="1144.5137"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="1506.8848" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="924.5" y="112.2871"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="1492.8848" style="stroke: #000000; stroke-width: 2.0;" width="1582" x="13" y="119.2871"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="1461.5742" style="stroke: #000000; stroke-width: 2.0;" width="1562" x="23" y="143.5977"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="524.5" x="850" y="227.2188"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="860" y="251.5293"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="347.4609"/><rect fill="#FFFFFF" height="481.3027" style="stroke: none; stroke-width: 1.0;" width="1562" x="23" y="627.2559"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="525.5" x="850" y="708.5215"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="505.5" x="860" y="732.832"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="828.7637"/><rect fill="#FFFFFF" height="496.6133" style="stroke: none; stroke-width: 1.0;" width="1562" x="23" y="1108.5586"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="121.5527" style="stroke: #000000; stroke-width: 2.0;" width="409.5" x="850" y="1189.8242"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="90.2422" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="860" y="1214.1348"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="1325.377"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="164" x2="164" y1="102.2871" y2="1629.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="424" x2="424" y1="102.2871" y2="1629.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="676" x2="676" y1="102.2871" y2="1629.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="929" x2="929" y1="102.2871" y2="1629.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1365" x2="1365" y1="102.2871" y2="1629.1719"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1501" x2="1501" y1="102.2871" y2="1629.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="37" y="62.7988"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="33" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="240" x="40" y="87.334">topic-usd-dfsp1-position-prepare</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="37" y="1628.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="33" y="1632.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="240" x="40" y="1652.707">topic-usd-dfsp1-position-prepare</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="309" y="62.7988"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="305" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="217" x="312" y="87.334">topic-usd-dfsp2-position-fulfil</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="309" y="1628.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="305" y="1632.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="217" x="312" y="1652.707">topic-usd-dfsp2-position-fulfil</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="558" y="62.7988"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="554" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="223" x="561" y="87.334">topic-usd-dfsp1-position-abort</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="558" y="1628.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="554" y="1632.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="223" x="561" y="1652.707">topic-usd-dfsp1-position-abort</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="870" y="99.334">Position Handler</text><ellipse cx="929.5" cy="69.7988" fill="#FEFECE" filter="url(#f1kxtnecmup16y)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="925.5,57.7988,931.5,52.7988,929.5,57.7988,931.5,62.7988,925.5,57.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="870" y="1641.707">Position Handler</text><ellipse cx="929.5" cy="1660.6602" fill="#FEFECE" filter="url(#f1kxtnecmup16y)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="925.5,1648.6602,931.5,1643.6602,929.5,1648.6602,931.5,1653.6602,925.5,1648.6602" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1317" y="62.7988"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1313" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1320" y="87.334">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1317" y="1628.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1313" y="1632.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1320" y="1652.707">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1432" y="62.7988"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1428" y="66.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1435" y="87.334">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1432" y="1628.1719"/><rect fill="#FEFECE" filter="url(#f1kxtnecmup16y)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1428" y="1632.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1435" y="1652.707">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="159" y="181.9082"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="419.5" y="663.2109"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="671.5" y="1144.5137"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="1506.8848" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="924.5" y="112.2871"/><path d="M13,119.2871 L236,119.2871 L236,126.2871 L226,136.2871 L13,136.2871 L13,119.2871 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1492.8848" style="stroke: #000000; stroke-width: 2.0;" width="1582" x="13" y="119.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="28" y="132.8555">Position Handler Consume</text><path d="M23,143.5977 L85,143.5977 L85,150.5977 L75,160.5977 L23,160.5977 L23,143.5977 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1461.5742" style="stroke: #000000; stroke-width: 2.0;" width="1562" x="23" y="143.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="157.166">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="213" x="100" y="156.2324">[Consume Prepare message for Payer]</text><polygon fill="#A80036" points="180,177.9082,170,181.9082,180,185.9082,176,181.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174" x2="923.5" y1="181.9082" y2="181.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="186" y="177.4766">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="199" y="177.4766">Consume Position event message for Payer</text><path d="M850,227.2188 L934,227.2188 L934,234.2188 L924,244.2188 L850,244.2188 L850,227.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="524.5" x="850" y="227.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="865" y="240.7871">break</text><path d="M860,251.5293 L1002,251.5293 L1002,258.5293 L992,268.5293 L860,268.5293 L860,251.5293 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="504.5" x="860" y="251.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="875" y="265.0977">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="976.5" y1="305.4609" y2="305.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="976.5" x2="976.5" y1="305.4609" y2="318.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="935.5" x2="976.5" y1="318.4609" y2="318.4609"/><polygon fill="#A80036" points="945.5,314.4609,935.5,318.4609,945.5,322.4609,941.5,318.4609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="293.0635">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="398" x="954.5" y="285.4082">Validate event - Rule: type == 'position' &amp;&amp; action == 'prepare'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="954.5" y="300.7188">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1038.5" y="300.7188">2001</text><path d="M860,347.4609 L1075,347.4609 L1075,354.4609 L1065,364.4609 L860,364.4609 L860,347.4609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="347.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="875" y="361.0293">Persist Event Information</text><polygon fill="#A80036" points="1353.5,406.7715,1363.5,410.7715,1353.5,414.7715,1357.5,410.7715" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1359.5" y1="410.7715" y2="410.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="406.3398">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="954.5" y="406.3398">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="867" y="419.082"/><polygon fill="#EEEEEE" points="867,419.082,931,419.082,931,426.082,921,436.082,867,436.082,867,419.082" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="433.6504">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1043" y="452.6504">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1201" y="452.6504">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1201" x2="1237" y1="454.6504" y2="454.6504"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1237" y="452.6504">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1047" y="467.9609"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="328" x="867" y="537.0137"/><polygon fill="#EEEEEE" points="867,537.0137,931,537.0137,931,544.0137,921,554.0137,867,554.0137,867,537.0137" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="551.582">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="873" y="570.582">Prepare Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="87" x="1098" y="570.582">1.3.1-prepare</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1098" x2="1185" y1="572.582" y2="572.582"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1185" y="570.582">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="877" y="585.8926"/><polygon fill="#A80036" points="1489.5,614.9453,1499.5,618.9453,1489.5,622.9453,1493.5,618.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1495.5" y1="618.9453" y2="618.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="614.5137">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="954.5" y="614.5137">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1585" y1="628.2559" y2="628.2559"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="28" y="638.8906">[Consume Fulfil message for Payee]</text><polygon fill="#A80036" points="440.5,659.2109,430.5,663.2109,440.5,667.2109,436.5,663.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434.5" x2="923.5" y1="663.2109" y2="663.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="446.5" y="658.7793">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="459.5" y="658.7793">Consume Position event message for Payee</text><path d="M850,708.5215 L934,708.5215 L934,715.5215 L924,725.5215 L850,725.5215 L850,708.5215 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.2422" style="stroke: #000000; stroke-width: 2.0;" width="525.5" x="850" y="708.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="865" y="722.0898">break</text><path d="M860,732.832 L1002,732.832 L1002,739.832 L992,749.832 L860,749.832 L860,732.832 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.9316" style="stroke: #000000; stroke-width: 2.0;" width="505.5" x="860" y="732.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="875" y="746.4004">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="976.5" y1="786.7637" y2="786.7637"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="976.5" x2="976.5" y1="786.7637" y2="799.7637"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="935.5" x2="976.5" y1="799.7637" y2="799.7637"/><polygon fill="#A80036" points="945.5,795.7637,935.5,799.7637,945.5,803.7637,941.5,799.7637" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="774.3662">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="399" x="954.5" y="766.7109">Validate event - Rule: type == 'position' &amp;&amp; action == 'commit'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="954.5" y="782.0215">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1038.5" y="782.0215">2001</text><path d="M860,828.7637 L1075,828.7637 L1075,835.7637 L1065,845.7637 L860,845.7637 L860,828.7637 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="828.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="875" y="842.332">Persist Event Information</text><polygon fill="#A80036" points="1353.5,888.0742,1363.5,892.0742,1353.5,896.0742,1357.5,892.0742" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1359.5" y1="892.0742" y2="892.0742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="887.6426">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="954.5" y="887.6426">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="867" y="900.3848"/><polygon fill="#EEEEEE" points="867,900.3848,931,900.3848,931,907.3848,921,917.3848,867,917.3848,867,900.3848" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="914.9531">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1043" y="933.9531">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1201" y="933.9531">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1201" x2="1237" y1="935.9531" y2="935.9531"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1237" y="933.9531">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1047" y="949.2637"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="297" x="867" y="1018.3164"/><polygon fill="#EEEEEE" points="867,1018.3164,931,1018.3164,931,1025.3164,921,1035.3164,867,1035.3164,867,1018.3164" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="1032.8848">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="873" y="1051.8848">Fulfil Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="70" x="1084" y="1051.8848">1.3.2-fulfil</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1084" x2="1154" y1="1053.8848" y2="1053.8848"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1154" y="1051.8848">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="877" y="1067.1953"/><polygon fill="#A80036" points="1489.5,1096.248,1499.5,1100.248,1489.5,1104.248,1493.5,1100.248" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1495.5" y1="1100.248" y2="1100.248"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="941.5" y="1095.8164">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="954.5" y="1095.8164">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1585" y1="1109.5586" y2="1109.5586"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="28" y="1120.1934">[Consume Abort message]</text><polygon fill="#A80036" points="692.5,1140.5137,682.5,1144.5137,692.5,1148.5137,688.5,1144.5137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686.5" x2="923.5" y1="1144.5137" y2="1144.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="698.5" y="1140.082">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="711.5" y="1140.082">Consume Position event message</text><path d="M850,1189.8242 L934,1189.8242 L934,1196.8242 L924,1206.8242 L850,1206.8242 L850,1189.8242 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="121.5527" style="stroke: #000000; stroke-width: 2.0;" width="409.5" x="850" y="1189.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="865" y="1203.3926">break</text><path d="M860,1214.1348 L1002,1214.1348 L1002,1221.1348 L992,1231.1348 L860,1231.1348 L860,1214.1348 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2422" style="stroke: #000000; stroke-width: 2.0;" width="389.5" x="860" y="1214.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="875" y="1227.7031">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="976.5" y1="1283.377" y2="1283.377"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="976.5" x2="976.5" y1="1283.377" y2="1296.377"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="935.5" x2="976.5" y1="1296.377" y2="1296.377"/><polygon fill="#A80036" points="945.5,1292.377,935.5,1296.377,945.5,1300.377,941.5,1296.377" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="941.5" y="1263.3242">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="963.5" y="1248.0137">Validate event - Rule: type == 'position' &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="963.5" y="1263.3242">action IN ['timeout-reserved', 'reject', 'fail']</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="963.5" y="1278.6348">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="1047.5" y="1278.6348">2001</text><path d="M860,1325.377 L1075,1325.377 L1075,1332.377 L1065,1342.377 L860,1342.377 L860,1325.377 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="157.5527" style="stroke: #000000; stroke-width: 2.0;" width="568" x="860" y="1325.377"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="875" y="1338.9453">Persist Event Information</text><polygon fill="#A80036" points="1353.5,1384.6875,1363.5,1388.6875,1353.5,1392.6875,1357.5,1388.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1359.5" y1="1388.6875" y2="1388.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="941.5" y="1384.2559">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="963.5" y="1384.2559">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="550" x="867" y="1396.998"/><polygon fill="#EEEEEE" points="867,1396.998,931,1396.998,931,1403.998,921,1413.998,867,1413.998,867,1396.998" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="1411.5664">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1043" y="1430.5664">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="36" x="1201" y="1430.5664">9.1.0.</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1201" x2="1237" y1="1432.5664" y2="1432.5664"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1237" y="1430.5664">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1047" y="1445.877"/><rect fill="#FFFFFF" filter="url(#f1kxtnecmup16y)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="303" x="867" y="1514.9297"/><polygon fill="#EEEEEE" points="867,1514.9297,931,1514.9297,931,1521.9297,921,1531.9297,867,1531.9297,867,1514.9297" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="880" y="1529.498">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="873" y="1548.498">Abort Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="73" x="1087" y="1548.498">1.3.3-abort</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1087" x2="1160" y1="1550.498" y2="1550.498"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1160" y="1548.498">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="877" y="1563.8086"/><polygon fill="#A80036" points="1489.5,1592.8613,1499.5,1596.8613,1489.5,1600.8613,1493.5,1596.8613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="934.5" x2="1495.5" y1="1596.8613" y2="1596.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="941.5" y="1592.4297">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="963.5" y="1592.4297">Produce message</text><!--
@startuml
title 1.3.0. Position Handler Consume (single message)

autonumber


collections "topic-usd-dfsp1-position-prepare" as TOPIC_POSITION_PREPARE_DFSP1
collections "topic-usd-dfsp2-position-fulfil" as TOPIC_POSITION_FULFIL_DFSP2
collections "topic-usd-dfsp1-position-abort" as TOPIC_POSITION_ABORT_DFSP1
control "Position Handler" as POS_HANDLER
collections "Event-Topic" as TOPIC_EVENTS
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Central Service" #LightYellow
    participant TOPIC_POSITION_PREPARE_DFSP1
    participant TOPIC_POSITION_FULFIL_DFSP2
    participant TOPIC_POSITION_ABORT_DFSP1
    participant POS_HANDLER
    participant TOPIC_EVENTS
    participant TOPIC_NOTIFICATIONS
end box

activate POS_HANDLER
group Position Handler Consume
    alt Consume Prepare message for Payer
        TOPIC_POSITION_PREPARE_DFSP1 <- POS_HANDLER: Consume Position event message for Payer
        activate TOPIC_POSITION_PREPARE_DFSP1
        deactivate TOPIC_POSITION_PREPARE_DFSP1
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'prepare'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Prepare Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.1-prepare.svg 1.3.1-prepare]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Fulfil message for Payee
        TOPIC_POSITION_FULFIL_DFSP2 <- POS_HANDLER: Consume Position event message for Payee
        activate TOPIC_POSITION_FULFIL_DFSP2
        deactivate TOPIC_POSITION_FULFIL_DFSP2
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' && action == 'commit'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Fulfil Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.2-fulfil.svg 1.3.2-fulfil]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Abort message
        TOPIC_POSITION_ABORT_DFSP1 <- POS_HANDLER: Consume Position event message
        activate TOPIC_POSITION_ABORT_DFSP1
        deactivate TOPIC_POSITION_ABORT_DFSP1
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type == 'position' &&\naction IN ['timeout-reserved', 'reject', 'fail']\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-event-9.1.0.svg 9.1.0.]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Abort Position Handler Consume {[[https://github.com/mojaloop/docs/blob/develop/CentralServices/seq_diagrams/seq-position-1.3.3-abort.svg 1.3.3-abort]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    end

end
deactivate POS_HANDLER
@enduml

PlantUML version 1.2018.01(Sun Jan 28 20:08:22 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b20
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>